version: 2

models:
  - name: stg_delivery_events
    description: "Cleaned staging layer for delivery events with standardized names and types.
                  Note: ~5.5% of delivery records have actual timestamps earlier than scheduled
  		  timestamps by >2 hours, likely due to upstream scheduling or timezone issues.
  		  A 7% tolerance threshold is enforced via dbt tests to catch regressions."
    columns:
      - name: event_id
        tests:
          - not_null
          - unique

      - name: load_id
        tests:
          - not_null

      - name: trip_id
        tests:
          - not_null

      - name: event_type
        tests:
          - not_null

      - name: scheduled_ts
        tests:
          - not_null

      - name: actual_ts
        tests:
          - not_null

      - name: on_time_flag
        tests:
          - not_null
          - accepted_values:
              values: ['Y', 'N']

      - name: detention_minutes
        tests:
          - not_null

      - name: location_state
        tests:
          - not_null
